<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kcc.banking.domain.account.mapper.AccountMapper">

    <resultMap id="AccountResultMap" type="AccountDetail">
        <id property="id" column="id" />
        <result property="branchId" column="branch_id" />
        <result property="customerId" column="customer_id" />
        <result property="productId" column="product_id" />
        <result property="empId" column="emp_id" />
        <result property="startDate" column="start_date" />
        <result property="preferentialInterestRate" column="preferential_interest_rate" />
        <result property="expireDate" column="expire_date" />
        <result property="password" column="password" />
        <result property="balance" column="balance" />
        <result property="openDate" column="open_date" />
        <result property="status" column="status" />
        <result property="tradeNumber" column="trade_number" />
        <result property="registrationDate" column="registration_date" />
        <result property="registrant" column="registrant" />
        <result property="modificationDate" column="modification_date" />
        <result property="modifier" column="modifier" />
        <result property="version" column="version" />
    </resultMap>

    <resultMap id="AccountProductInfoMap" type="AccountProductInfo">
        <id property="id" column="id" />
        <result property="name" column="name" />
        <result property="interestRate" column="interest_rate" />
    </resultMap>

    <select id="findAll" resultMap="AccountResultMap">
        SELECT * FROM account
    </select>

    <select id="findAccountProductInfo" resultMap="AccountProductInfoMap" >
        select * from product
        where id = 1
    </select>

    <select id="getAccountSeq" resultType="int">
        SELECT account_seq.NEXTVAL
        FROM dual
    </select>

    <insert id="openAccount" parameterType="AccountCreate">
        INSERT INTO Account (
                                id,
                                branch_id,
                                customer_id,
                                product_id,
                                emp_id,
                                start_date,
                                preferential_interest_rate,
                                password,
                                balance,
                                open_date,
                                status
        ) VALUES (
                        #{id}, #{branchId}, #{customerId}, #{productId}, #{empId},
                        #{startDate}, #{preferentialInterestRate},
                        #{password}, #{balance}, sysdate, OPN
                 )
    </insert>
</mapper>